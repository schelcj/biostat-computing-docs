<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Bisotatistics Cluster Jobs</title>
	<link type="text/css" rel="stylesheet" href="/css/sph.css"/>
	<link type="text/css" rel="stylesheet" href="/biostat/css/stylesheet.css"/>
	<link type="text/css" rel="stylesheet" href="/biostat/computing/overrides.css"/>
<link rel="stylesheet" type="text/css" href="/css/print.css" media="print" />
<link rel="stylesheet" type="text/css" href="/css/mobile.css" media="handheld" />
	<meta name="breadcrumb" content="sph|biostat|computing|cluster"/>
	<meta name="alt_formats" content="txt"/>
</head>
<body>
<!--#include virtual="/biostat/computing/header.shtml" -->

<h1 id="jobs">Jobs</h1>

<ol>
<li><a href="#queueingpolicy">Queueing Policy</a></li>
<li><a href="#jobprioritization">Job Prioritization</a></li>
<li><a href="#limitations">Limitations</a></li>
<li><a href="#partitions">Partitions</a></li>
</ol>

<h3 id="queueingpolicy">Queueing Policy</h3>

<p>All jobs are scheduled on a <a href="http://en.wikipedia.org/wiki/FIFO">FIFO</a> with backfill. The backfill scheduler
will initiate a lower-priority job if doing so does not delay the
expected initiation time of higher priority jobs; essentially using smaller
jobs to fill holes in the resource allocation plan.</p>

<h3 id="jobprioritization">Job Prioritization</h3>

<p>All jobs in the queue are assigned a priority that increases over time. The higher
the priority the sooner a job is scheduled to run. This priority is a weighted sum
of several factors. These factors include <a href="http://www.schedmd.com/slurmdocs/priority_multifactor.html#fairshare">Fairshare</a> and <a href="http://www.schedmd.com/slurmdocs/priority_multifactor.html#age">Job Age</a>. The fairshare
is a means of weighting jobs based on their allocated computing resources and the history
of resources that have been consumed in the past. The job age is just a factor of the amount
of time a job has been eligible to run but waited on resources to become available. </p>

<p>To view a jobs priority use the scontrol or sprio commands:</p>

<pre><code>$ scontrol show job 580425
JobId=580425 Name=fac1000
  UserId=schelcj(966674) GroupId=biostat-users(1001)
  Priority=24944 Account=biostat QOS=biostat
  JobState=RUNNING Reason=None Dependency=(null)
  Requeue=1 Restarts=0 BatchFlag=1 ExitCode=0:0
  RunTime=00:58:06 TimeLimit=16-00:00:00 TimeMin=N/A
  SubmitTime=2012-03-22T13:02:57 EligibleTime=2012-03-22T13:02:57
  StartTime=2012-03-22T13:08:08 EndTime=2012-04-07T13:08:08
  PreemptTime=None SuspendTime=None SecsPreSuspend=0
  Partition=biostat-default AllocNode:Sid=idran:17807
  ReqNodeList=(null) ExcNodeList=(null)
  NodeList=vulcan
  BatchHost=vulcan
  NumNodes=1 NumCPUs=1 CPUs/Task=1 ReqS:C:T=*:*:*
  MinCPUsNode=1 MinMemoryNode=2000M MinTmpDiskNode=0
  Features=(null) Gres=SAS Reservation=(null)
  Shared=OK Contiguous=0 Licenses=(null) Network=(null)
  Command=/home/schelcj/debug/sas/foo/./job.txt
  WorkDir=/home/schelcj/debug/sas/foo

$ sprio -j 580427 -l
JOBID     USER   PRIORITY        AGE  FAIRSHARE    JOBSIZE  PARTITION        QOS   NICE
580427     foo        561         49        513          0          0          0      0
</code></pre>

<p><em>There may be an additional factor applied to users whose faculty advisor has
contributed nodes but at this time that is not the case.</em>
<em>See the Slurm documentation for all the <a href="http://www.schedmd.com/slurmdocs/priority_multifactor.html">gory details</a> if you are so inclined.</em></p>

<h3 id="limitations">Limitations</h3>

<ul>
<li>Maximum wallclock time of 28 days for all jobs.</li>
<li>Maximum of 1000 jobs in the queue regardless of state (ie; running, pending) per user.</li>
<li>Unless requested each job defaults to one cpu core and 1GB of memory per job. You can request more with various options to salloc/srun/sbatch.</li>
<li>Time argument <em>(&#8211;time=)</em> is required otherwise default time of 10 minutes is applied to your job.</li>
<li>Maximum core usage, in aggregate, by a single user is 65% of the total cores available.</li>
</ul>

<h3 id="partitions">Partitions</h3>

<p>Partitions in <a href="https://computing.llnl.gov/linux/slurm/">SLURM</a> are groupings of computation nodes, similiar to queues in other schedulers, that are used
for logical collections of resources. We have several partitions defined that are available for your jobs. Which
partition you use depends on your job requirements or research group.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Name</th>
	<th style="text-align:left;">Nodes</th>
	<th style="text-align:left;">Access Group</th>
	<th style="text-align:left;">Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">biostat-default</td>
	<td style="text-align:left;">cn0[01&#8211;18],andoria,tellar,vulcan</td>
	<td style="text-align:left;">biostat-users</td>
	<td style="text-align:left;">Default partition for all users</td>
</tr>
</tbody>
</table>
<!--#include virtual="/biostat/computing/footer.shtml" -->
</body>
</html>
